<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Editor de Template</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
    }
    .editor-container {
      display: flex;
    }
    .editor {
      position: relative;
      width: 600px;
      height: 400px;
      border: 1px solid #ccc;
      margin-right: 20px;
    }
    #backgroundImage {
      position: absolute;
      width: 100%;
      height: 100%;
      z-index: 1;
    }
    .draggable {
      position: absolute;
      cursor: move;
      z-index: 2;
    }
    #textElement {
      font-size: 24px;
      color: black;
    }
    .controls {
      width: 300px;
      background-color: #f4f4f4;
      padding: 10px;
      border-radius: 8px;
      box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.1);
    }
    .controls label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }
    .controls input, .controls select {
      width: 100%;
      padding: 5px;
      margin-top: 5px;
      margin-bottom: 10px;
      border-radius: 4px;
      border: 1px solid #ccc;
    }
    .color-options {
      display: flex;
      justify-content: space-between;
    }
    .color-options input {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      cursor: pointer;
    }
    .text-options {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
    }
    .text-options button {
      border: none;
      background: #fff;
      cursor: pointer;
      padding: 5px;
      border-radius: 4px;
      box-shadow: 0px 1px 5px rgba(0, 0, 0, 0.1);
    }
    .text-options button:hover {
      background-color: #ddd;
    }
    .bold {
      font-weight: bold;
    }
    .italic {
      font-style: italic;
    }
    .underline {
      text-decoration: underline;
    }
  </style>
</head>
<body>

  <div class="editor-container">
    <div class="editor" id="editor">
      <img id="backgroundImage" src="" alt="Background">
      <div class="draggable" id="textElement">Texto Dinâmico</div>
      <img src="" id="profileImage" class="draggable" width="100" height="100" alt="Foto de Perfil">
    </div>

    <div class="controls">
      <h3>Opções de Texto</h3>

      <label for="textInput">Texto</label>
      <input type="text" id="textInput" value="Texto Dinâmico">

      <label for="fontSize">Tamanho da Fonte</label>
      <input type="number" id="fontSize" value="24" min="10" max="72">

      <label for="fontFamily">Fonte</label>
      <select id="fontFamily">
        <option value="Arial">Arial</option>
        <option value="OpenSans-SemiBold">OpenSans-SemiBold</option>
        <option value="Times New Roman">Times New Roman</option>
        <option value="Verdana">Verdana</option>
      </select>

      <label for="textColor">Cor do Texto</label>
      <input type="color" id="textColor" value="#000000">

      <div class="text-options">
        <button id="boldBtn">B</button>
        <button id="italicBtn"><i>I</i></button>
        <button id="underlineBtn"><u>U</u></button>
      </div>

      <label for="bgUpload">Imagem de Fundo</label>
      <input type="file" id="bgUpload" accept="image/*">

      <button id="generateJSON">Gerar JSON</button>
    </div>
  </div>

  <script>
    // Função para permitir arrastar os elementos
    function makeDraggable(element) {
      let isDragging = false;
      let offsetX, offsetY;

      element.addEventListener('mousedown', function(e) {
        isDragging = true;
        offsetX = e.clientX - element.getBoundingClientRect().left;
        offsetY = e.clientY - element.getBoundingClientRect().top;
      });

      document.addEventListener('mousemove', function(e) {
        if (isDragging) {
          element.style.left = (e.clientX - offsetX) + 'px';
          element.style.top = (e.clientY - offsetY) + 'px';
        }
      });

      document.addEventListener('mouseup', function() {
        isDragging = false;
      });
    }

    // Iniciar elementos como arrastáveis
    const textElement = document.getElementById('textElement');
    const profileImage = document.getElementById('profileImage');
    makeDraggable(textElement);
    makeDraggable(profileImage);

    // Alterar texto, tamanho, fonte e cor do texto
    document.getElementById('textInput').addEventListener('input', function(e) {
      textElement.textContent = e.target.value;
    });
    document.getElementById('fontSize').addEventListener('input', function(e) {
      textElement.style.fontSize = e.target.value + 'px';
    });
    document.getElementById('fontFamily').addEventListener('change', function(e) {
      textElement.style.fontFamily = e.target.value;
    });
    document.getElementById('textColor').addEventListener('input', function(e) {
      textElement.style.color = e.target.value;
    });

    // Botões de estilo de texto
    document.getElementById('boldBtn').addEventListener('click', function() {
      textElement.classList.toggle('bold');
    });
    document.getElementById('italicBtn').addEventListener('click', function() {
      textElement.classList.toggle('italic');
    });
    document.getElementById('underlineBtn').addEventListener('click', function() {
      textElement.classList.toggle('underline');
    });

    // Upload da imagem de fundo
    document.getElementById('bgUpload').addEventListener('change', function(e) {
      const reader = new FileReader();
      reader.onload = function(event) {
        document.getElementById('backgroundImage').src = event.target.result;
      };
      reader.readAsDataURL(e.target.files[0]);
    });

    // Gerar JSON com a estrutura do template
    document.getElementById('generateJSON').addEventListener('click', function() {
      const bgImage = document.getElementById('backgroundImage').src;
      const textContent = document.getElementById('textElement').textContent;
      const textColor = document.getElementById('textElement').style.color;
      const textFontSize = document.getElementById('textElement').style.fontSize || '24px';
      const textFontFamily = document.getElementById('textElement').style.fontFamily || 'Arial';
      const textPosition = {
        top: document.getElementById('textElement').style.top || '0px',
        left: document.getElementById('textElement').style.left || '0px'
      };
      const profileImgSrc = document.getElementById('profileImage').src;
      const profilePosition = {
        top: document.getElementById('profileImage').style.top || '0px',
        left: document.getElementById('profileImage').style.left || '0px'
      };

      const template = {
        backgroundImage: bgImage,
        text: {
          content: "{{dynamic_text}}", // Placeholder para texto dinâmico
          fontSize: textFontSize,
          fontFamily: textFontFamily,
          color: textColor,
          position: textPosition
        },
        profileImage: {
          src: "{{dynamic_profile_image}}", // Placeholder para imagem de perfil dinâmica
          position: profilePosition
        }
      };

      console.log(JSON.stringify(template, null, 2));
      alert('Template salvo! Veja o console para detalhes.');
    });
  </script>

</body>
</html>
