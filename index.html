<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Editor de Template</title>
  <style>
    body {
      font-family: Arial, sans-serif;
    }
    .editor {
      position: relative;
      width: 600px;
      height: 400px;
      border: 1px solid #ccc;
      margin-bottom: 10px;
    }
    #backgroundImage {
      position: absolute;
      width: 100%;
      height: 100%;
      z-index: 1;
    }
    .draggable {
      position: absolute;
      cursor: move;
      z-index: 2;
    }
    #textElement {
      font-size: 24px;
      color: black;
    }
    .controls {
      margin-top: 10px;
    }
  </style>
</head>
<body>

  <h2>Editor de Template</h2>

  <div class="editor" id="editor">
    <img id="backgroundImage" src="" alt="Background">
    <div class="draggable" id="textElement">Texto Dinâmico</div>
    <img src="" id="profileImage" class="draggable" width="100" height="100" alt="Foto de Perfil">
  </div>

  <div class="controls">
    <label for="bgUpload">Alterar Imagem de Fundo:</label>
    <input type="file" id="bgUpload" accept="image/*"><br>

    <label for="textInput">Alterar Texto:</label>
    <input type="text" id="textInput" value="Texto Dinâmico"><br>

    <label for="textColor">Cor do Texto:</label>
    <input type="color" id="textColor" value="#000000"><br>

    <label for="profileUpload">Alterar Foto de Perfil:</label>
    <input type="file" id="profileUpload" accept="image/*"><br>

    <button id="saveTemplate">Salvar Template</button>
  </div>

  <script>
    // Função para permitir arrastar os elementos
    function makeDraggable(element) {
      let isDragging = false;
      let offsetX, offsetY;

      element.addEventListener('mousedown', function(e) {
        isDragging = true;
        offsetX = e.clientX - element.getBoundingClientRect().left;
        offsetY = e.clientY - element.getBoundingClientRect().top;
      });

      document.addEventListener('mousemove', function(e) {
        if (isDragging) {
          element.style.left = (e.clientX - offsetX) + 'px';
          element.style.top = (e.clientY - offsetY) + 'px';
        }
      });

      document.addEventListener('mouseup', function() {
        isDragging = false;
      });
    }

    // Iniciar elementos como arrastáveis
    const textElement = document.getElementById('textElement');
    const profileImage = document.getElementById('profileImage');
    makeDraggable(textElement);
    makeDraggable(profileImage);

    // Alterar imagem de fundo
    document.getElementById('bgUpload').addEventListener('change', function(e) {
      const reader = new FileReader();
      reader.onload = function(event) {
        document.getElementById('backgroundImage').src = event.target.result;
      };
      reader.readAsDataURL(e.target.files[0]);
    });

    // Alterar texto e cor do texto
    document.getElementById('textInput').addEventListener('input', function(e) {
      textElement.textContent = e.target.value;
    });
    document.getElementById('textColor').addEventListener('input', function(e) {
      textElement.style.color = e.target.value;
    });

    // Alterar foto de perfil
    document.getElementById('profileUpload').addEventListener('change', function(e) {
      const reader = new FileReader();
      reader.onload = function(event) {
        document.getElementById('profileImage').src = event.target.result;
      };
      reader.readAsDataURL(e.target.files[0]);
    });

    // Função para salvar o template como JSON
    document.getElementById('saveTemplate').addEventListener('click', function() {
      const bgImage = document.getElementById('backgroundImage').src;
      const textContent = document.getElementById('textElement').textContent;
      const textColor = document.getElementById('textElement').style.color;
      const textFontSize = document.getElementById('textElement').style.fontSize || '24px';
      const textPosition = {
        top: document.getElementById('textElement').style.top || '0px',
        left: document.getElementById('textElement').style.left || '0px'
      };
      const profileImgSrc = document.getElementById('profileImage').src;
      const profilePosition = {
        top: document.getElementById('profileImage').style.top || '0px',
        left: document.getElementById('profileImage').style.left || '0px'
      };

      const template = {
        backgroundImage: bgImage,
        text: {
          content: "{{dynamic_text}}", // Placeholder para texto dinâmico
          fontSize: textFontSize,
          color: textColor,
          position: textPosition
        },
        profileImage: {
          src: "{{dynamic_profile_image}}", // Placeholder para imagem de perfil dinâmica
          position: profilePosition
        }
      };

      console.log(JSON.stringify(template, null, 2));
      alert('Template salvo! Veja o console para detalhes.');
    });
  </script>

</body>
</html>
